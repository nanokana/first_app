<?xml version="1.0" encoding="EUC-JP" ?>
<!DOCTYPE html 
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>OpenSSL::PKCS7</title>
<meta http-equiv="Content-type" content="text/html; charset=EUC-JP" />
<link href="default.css" type="text/css" rel="stylesheet" />
<link href="refm231.html" rel="next" />
<link href="refm229.html" rel="prev" />
<link href="index.html" rel="start" />

</head>
<body>
<div class="navigator"><span class="navigator">[<a href="index.html">MAIN</a>][<a href="refm539.html">INDEX</a>]&nbsp;&nbsp;&nbsp;[<a href="index.html">TOP</a>][<a href="refm213.html">UP</a>][<a href="refm229.html">&lt;-PREV</a>][<a href="refm231.html">NEXT-&gt;</a>]</span></div>
<hr />

<h1><a name="L004563" id="L004563">OpenSSL::PKCS7</a></h1>
<p>PKCS #7 モジュール </p>
<p><a href="refm231.html">OpenSSL::PKCS7::PKCS7</a> も参照。</p>
<h2><a name="L004564" id="L004564">モジュールメソッド</a></h2>
<dl>
<dt><a name="L004565" id="L004565"><code>PKCS7.read_smime(<var>str</var>)</code></a>
<dt><a name="L004566" id="L004566"><code>PKCS7.read_smime(<var>io</var>)</code></a></dt>
<dd>
<p>S/MIME 形式を読み込み、PKCS7 オブジェクトを返す。</p></dd>
<dt><a name="L004567" id="L004567"><code>PKCS7.write_smime(<var>p7sig</var>)</code></a>
<dt><a name="L004568" id="L004568"><code>PKCS7.write_smime(<var>p7sig</var>, <var>data</var>, <var>flags</var>=<var>DETACHED</var>)</code></a></dt>
<dd>
<p>PKCS7 オブジェクトから S/MIME 形式の文字列を返す。
multipart/signed による平文署名である場合、署名されたデータを data として与えなければいけない。</p>
<pre>data = &quot;hoge&quot;
p7 = PKCS7.sign( X509::Certificate.new(File.read('cert.pem')), 
                 PKey::RSA.new(File.read('privkey.pem')), 
                 data)
smime = PKCS7.write_smime(p7, data)</pre></dd>
<dt><a name="L004569" id="L004569"><code>PKCS7.sign(<var>cert</var>, <var>key</var>, <var>data</var>, []=<var>nil</var>, <var>flags</var>=<var>0</var>)</code></a></dt>
<dd>
<p>data に証明書 cert を付けて key で署名する。</p></dd>
<dt><a name="L004570" id="L004570"><code>PKCS7.encrypt([<var>rcpt</var>], <var>smime</var>)</code></a></dt>
<dd>
<p>S/MIME 形式の文字列をメッセージの受け取り手の公開鍵 rcpt を使って暗号化する。</p></dd>
</dl>
<h2><a name="L004571" id="L004571">定数</a></h2>
<dl>
<dt><a name="L004572" id="L004572"><code>DETACHED</code></a></dt>
<dd>
<p>平文に署名を付ける形式(multipart/signed)で行う。 PKCS7.sign() において DETACHED がセットされていた時にだけ意味をもつ。</p></dd>
<dt><a name="L004573" id="L004573"><code>TEXT</code></a></dt>
<dd>
<p>text/plain のためのコンテンツに MIME ヘッダーを加える。DETACHED ビットが立っている時だけ意味をもつ。</p></dd>
<dt><a name="L004574" id="L004574"><code>BINARY</code></a></dt>
<dd>
<p>MIME canonical format への変換を行わない。</p></dd>
<dt><a name="L004575" id="L004575"><code>NOATTR</code></a></dt>
<dd>
<p>署名した時間などの情報を省略。</p></dd>
<dt><a name="L004576" id="L004576"><code>NOCERTS</code></a></dt>
<dd>
<p>署名者の証明書を署名に含めない。送り先がすでに証明書をもっている場合、データの量を減らすことができる。</p></dd>
<dt><a name="L004577" id="L004577"><code>NOCHAIN</code></a>
<dt><a name="L004578" id="L004578"><code>NOINTERN</code></a>
<dt><a name="L004579" id="L004579"><code>NOSIGS</code></a>
<dt><a name="L004580" id="L004580"><code>NOSMIMECAP</code></a></dt>
<dd>
<p>署名者が使用可能な暗号アルゴリズムの情報などを省略。</p></dd>
<dt><a name="L004581" id="L004581"><code>NOVERIFY</code></a>
</dl>

<hr />
<div class="navigator"><span class="navigator">[<a href="index.html">MAIN</a>][<a href="refm539.html">INDEX</a>]&nbsp;&nbsp;&nbsp;[<a href="index.html">TOP</a>][<a href="refm213.html">UP</a>][<a href="refm229.html">&lt;-PREV</a>][<a href="refm231.html">NEXT-&gt;</a>]</span></div>

</body>
</html>
