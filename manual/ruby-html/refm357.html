<?xml version="1.0" encoding="EUC-JP" ?>
<!DOCTYPE html 
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>dl/struct</title>
<meta http-equiv="Content-type" content="text/html; charset=EUC-JP" />
<link href="default.css" type="text/css" rel="stylesheet" />
<link href="refm358.html" rel="next" />
<link href="refm356.html" rel="prev" />
<link href="index.html" rel="start" />

</head>
<body>
<div class="navigator"><span class="navigator">[<a href="index.html">MAIN</a>][<a href="refm539.html">INDEX</a>]&nbsp;&nbsp;&nbsp;[<a href="index.html">TOP</a>][<a href="refm356.html">UP</a>][<a href="refm356.html">&lt;-PREV</a>][<a href="refm358.html">NEXT-&gt;</a>]</span></div>
<hr />

<h1><a name="L006811" id="L006811">dl/struct</a></h1>
<ul>
<li><a href="refm351.html">dl</a></li>
<li><a href="refm356.html">DL::Importable</a></li>
<li><a href="refm358.html">DL::Types</a></li>
</ul>
<h2><a name="L006812" id="L006812">DL::Importable</a></h2>
<h3><a name="L006813" id="L006813">概要</a></h3>
<p>DL::Importableをextendしたモジュールに構造体/共用体を定義する機能を与える。</p>
<h3><a name="L006814" id="L006814">メソッド</a></h3>
<dl>
<dt><a name="L006815" id="L006815"><code>define_struct(<var>contents</var>)</code></a>
<dt><a name="L006816" id="L006816"><code>struct(<var>contents</var>)</code></a></dt>
<dd>
<p>構造体を定義する。
<var>contents</var>については <a href="#L006825">DL::Importable::Struct.new</a>
を参照せよ。</p></dd>
<dt><a name="L006817" id="L006817"><code>define_union(<var>contents</var>)</code></a>
<dt><a name="L006818" id="L006818"><code>union(<var>contents</var>)</code></a></dt>
<dd>
<p>共用体を定義する。
<var>contents</var>については上記<code>define_struct</code>と同様である。</p></dd>
</dl>
<h2><a name="L006819" id="L006819">DL::Importable::Memory</a></h2>
<h3><a name="L006813" id="L006813">概要</a></h3>
<p><code>DL::PtrData</code>のラッパー用クラス。
ドット形式で構造体や共用体の要素へアクセスできるようになる。
Struct,Unionのインスタンスのmalloc,newメソッドを呼ぶことによって、
Memoryクラスのインスタンスが生成できる。そのため、通常、直接生成する必要はない。</p>
<h3><a name="L006820" id="L006820">クラスメソッド</a></h3>
<dl>
<dt><a name="L006821" id="L006821"><code>Memory.new(<var>ptr</var>, <var>names</var>, <var>ty</var>, <var>len</var>, <var>enc</var>, <var>dec</var>)</code></a></dt>
<dd>
<p>DL::PtrDataオブジェクト<var>ptr</var>の各メンバへアクセスするためのメソッドを
動的に定義する。Struct,Unionのインスタンスがこれらの情報を保持する。</p></dd>
</dl>
<h3><a name="L006814" id="L006814">メソッド</a></h3>
<dl>
<dt><a name="L006822" id="L006822"><code>to_ptr</code></a></dt>
<dd>
<p>保持しているDL::PtrDataオブジェクトを返す。</p></dd>
<dt><a name="L006823" id="L006823"><code>size</code></a></dt>
<dd>
<p>DL::PtrData#sizeを呼ぶ。</p></dd>
</dl>
<h2><a name="L006824" id="L006824">DL::Importable::Struct</a></h2>
<h3><a name="L006820" id="L006820">クラスメソッド</a></h3>
<dl>
<dt><a name="L006825" id="L006825"><code>Struct.new(<var>types</var>, <var>contents</var>)</code></a></dt>
<dd>
<p><var>types</var>にはDL::Typesのインスタンス、<var>contents</var>には構造体の定義を
以下のようにして与える。</p>
<pre>[&quot;int size&quot;,
 &quot;char *str&quot;]</pre>
<p>このようにして生成されたStructオブジェクトは、以下の構造体のように振舞う。</p>
<pre>struct {
  int size;
  char *str;
}</pre></dd>
</dl>
<h3><a name="L006814" id="L006814">メソッド</a></h3>
<dl>
<dt><a name="L006826" id="L006826"><code>new(<var>ptr</var>)</code></a></dt>
<dd>
<p><a href="refm355.html">DL::PtrData</a> オブジェクト <var>ptr</var> を保持する Memory オブジェクトを返す。</p></dd>
<dt><a name="L006827" id="L006827"><code>malloc(<var>size</var> = <var>nil</var>)</code></a></dt>
<dd>
<p><var>size</var>バイトの領域を確保してDL::PtrDataオブジェクトを生成し、その
DL::PtrDataオブジェクトを保持するMemoryオブジェクトを返す。</p></dd>
</dl>
<h2><a name="L006828" id="L006828">DL::Importable::Union</a></h2>
<p>共用体に対するクラスである以外は、Structとほぼ同じ。</p>
<h2><a name="L006829" id="L006829">補足</a></h2>
<p>上記メソッドやクラスは、実際にはDL::Importable::Internalに定義されている。</p>

<hr />
<div class="navigator"><span class="navigator">[<a href="index.html">MAIN</a>][<a href="refm539.html">INDEX</a>]&nbsp;&nbsp;&nbsp;[<a href="index.html">TOP</a>][<a href="refm356.html">UP</a>][<a href="refm356.html">&lt;-PREV</a>][<a href="refm358.html">NEXT-&gt;</a>]</span></div>

</body>
</html>
